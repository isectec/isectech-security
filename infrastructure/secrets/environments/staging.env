# iSECTECH Staging Environment Secret Configuration
# Environment-specific settings for Google Cloud Secret Manager
# Author: Claude Code - iSECTECH Infrastructure Team
# Version: 2.0.0

# ═══════════════════════════════════════════════════════════════════════════════
# ENVIRONMENT CONFIGURATION
# ═══════════════════════════════════════════════════════════════════════════════

ENVIRONMENT=staging
PROJECT_ID=isectech-staging-platform
REGION=us-central1
ZONE=us-central1-b

# ═══════════════════════════════════════════════════════════════════════════════
# CLOUD SQL INSTANCES (Staging)
# ═══════════════════════════════════════════════════════════════════════════════

# PostgreSQL (Primary Database)
POSTGRES_INSTANCE_CONNECTION_NAME=isectech-staging-platform:us-central1:isectech-postgres-staging
POSTGRES_HOST=127.0.0.1  # Via Cloud SQL Proxy
POSTGRES_PORT=5432
POSTGRES_SSL_MODE=require

# MongoDB (Document Storage) - Using smaller Atlas cluster
MONGODB_CLUSTER_URI=mongodb+srv://staging-cluster.isectech.mongodb.net
MONGODB_SSL=true
MONGODB_AUTH_SOURCE=admin

# Redis (Cache/Sessions) - Using Cloud Memorystore (smaller instance)
REDIS_HOST=10.1.0.100  # Private IP in staging VPC
REDIS_PORT=6379
REDIS_SSL=true

# ClickHouse (Analytics) - Using smaller Cloud Run instance
CLICKHOUSE_HOST=clickhouse-staging.isectech.com
CLICKHOUSE_PORT=8443
CLICKHOUSE_SECURE=1

# ═══════════════════════════════════════════════════════════════════════════════
# SERVICE MESH CONFIGURATION
# ═══════════════════════════════════════════════════════════════════════════════

# Istio Service Mesh
SERVICE_MESH_ENABLED=true
SERVICE_MESH_NAMESPACE=isectech-staging
MUTUAL_TLS_MODE=PERMISSIVE  # More lenient for testing

# Kong API Gateway
KONG_ADMIN_API_URI=https://kong-admin-staging.isectech.com:8001
KONG_PROXY_URI=https://api-staging.isectech.com
KONG_DATABASE=postgres

# ═══════════════════════════════════════════════════════════════════════════════
# OAUTH PROVIDER CONFIGURATION (Test Applications)
# ═══════════════════════════════════════════════════════════════════════════════

# Google OAuth (Staging App)
GOOGLE_OAUTH_REDIRECT_URI=https://protect-staging.isectech.com/api/auth/callback/google
GOOGLE_OAUTH_SCOPE=openid profile email

# Microsoft OAuth (Staging App)
MICROSOFT_OAUTH_TENANT=isectech.onmicrosoft.com
MICROSOFT_OAUTH_REDIRECT_URI=https://protect-staging.isectech.com/api/auth/callback/microsoft
MICROSOFT_OAUTH_SCOPE=openid profile email

# Okta OAuth (Staging Org)
OKTA_DOMAIN=isectech-staging.okta.com
OKTA_OAUTH_REDIRECT_URI=https://protect-staging.isectech.com/api/auth/callback/okta
OKTA_OAUTH_SCOPE=openid profile email

# ═══════════════════════════════════════════════════════════════════════════════
# EXTERNAL API ENDPOINTS (Test/Sandbox)
# ═══════════════════════════════════════════════════════════════════════════════

# Threat Intelligence APIs (Test keys with lower limits)
VIRUSTOTAL_API_URL=https://www.virustotal.com/vtapi/v2
RECORDED_FUTURE_API_URL=https://api.recordedfuture.com/v2
MISP_API_URL=https://misp-staging.isectech.com
SHODAN_API_URL=https://api.shodan.io

# Security Tool APIs (Staging instances)
NESSUS_API_URL=https://nessus-staging.isectech.com:8834
OPENVAS_API_URL=https://openvas-staging.isectech.com:9392
QUALYS_API_URL=https://qualysapi.qualys.com

# SIEM Integration APIs (Staging)
SPLUNK_HEC_URL=https://splunk-staging.isectech.com:8088/services/collector
ELASTICSEARCH_URL=https://elasticsearch-staging.isectech.com:9200
LOGSTASH_URL=https://logstash-staging.isectech.com:5044

# SOAR Platform APIs (Staging)
PHANTOM_API_URL=https://phantom-staging.isectech.com/rest
DEMISTO_API_URL=https://demisto-staging.isectech.com/api/v1
THEHIVE_API_URL=https://thehive-staging.isectech.com/api

# ═══════════════════════════════════════════════════════════════════════════════
# COMMUNICATION SERVICES (Test Configurations)
# ═══════════════════════════════════════════════════════════════════════════════

# Email Configuration (Test SMTP)
SMTP_HOST=smtp.mailtrap.io
SMTP_PORT=587
SMTP_USE_TLS=true
SMTP_FROM_ADDRESS=staging-alerts@isectech.com
SMTP_FROM_NAME=iSECTECH Staging Platform

# Slack Integration (Test channel)
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/T00000000/B00000000/STAGING_WEBHOOK
SLACK_CHANNEL=#security-alerts-staging
SLACK_USERNAME=iSECTECH-Staging-Bot

# SMS/Voice Notifications (Test Twilio)
TWILIO_ACCOUNT_SID=AC_STAGING_1234567890abcdef1234567890abcdef
TWILIO_PHONE_NUMBER=+15551234568

# PagerDuty Integration (Test integration)
PAGERDUTY_API_URL=https://api.pagerduty.com
PAGERDUTY_ROUTING_KEY=STAGING_PAGERDUTY_ROUTING_KEY

# ═══════════════════════════════════════════════════════════════════════════════
# MONITORING AND OBSERVABILITY (Staging)
# ═══════════════════════════════════════════════════════════════════════════════

# Error Tracking (Staging project)
SENTRY_DSN=https://staging-placeholder@sentry.io/1234568
SENTRY_ENVIRONMENT=staging
SENTRY_SAMPLE_RATE=1.0  # Higher sample rate for testing

# Application Performance Monitoring (Staging)
NEW_RELIC_APP_NAME=iSECTECH-Staging
NEW_RELIC_LABELS=Environment:staging;Datacenter:us-central1

# Analytics (Test tracking)
GOOGLE_ANALYTICS_MEASUREMENT_ID=G-STAGING_PLACEHOLDER
MIXPANEL_PROJECT_TOKEN=staging_mixpanel_token

# ═══════════════════════════════════════════════════════════════════════════════
# CLOUD SERVICES (Staging)
# ═══════════════════════════════════════════════════════════════════════════════

# Google Cloud Services
GCS_BUCKET_NAME=isectech-staging-storage
GCS_REGION=us-central1
GOOGLE_MAPS_ENABLED=true

# AWS Services (Multi-cloud staging)
AWS_REGION=us-east-1
S3_BUCKET_NAME=isectech-staging-backup
S3_STORAGE_CLASS=STANDARD

# Third-party Services
MAPBOX_STYLE_URL=mapbox://styles/isectech/staging-style
CLOUDINARY_CLOUD_NAME=isectech-staging

# ═══════════════════════════════════════════════════════════════════════════════
# SECURITY CONFIGURATION (Relaxed for Testing)
# ═══════════════════════════════════════════════════════════════════════════════

# TLS Configuration
TLS_MIN_VERSION=1.2
TLS_CIPHER_SUITES=ECDHE-RSA-AES256-GCM-SHA384,ECDHE-RSA-AES128-GCM-SHA256
CERTIFICATE_PROVIDER=google-managed

# Session Configuration (More permissive for testing)
SESSION_COOKIE_SECURE=true
SESSION_COOKIE_HTTP_ONLY=true
SESSION_COOKIE_SAME_SITE=lax  # More permissive for testing
SESSION_TIMEOUT_MINUTES=720  # Longer for testing
SESSION_ABSOLUTE_TIMEOUT_HOURS=24
SESSION_IDLE_TIMEOUT_MINUTES=120

# CORS Configuration (More permissive)
CORS_ALLOWED_ORIGINS=https://protect-staging.isectech.com,https://api-staging.isectech.com,http://localhost:3000,http://localhost:8080
CORS_ALLOWED_METHODS=GET,POST,PUT,DELETE,OPTIONS,PATCH
CORS_ALLOWED_HEADERS=Content-Type,Authorization,X-Requested-With,X-Test-Header
CORS_CREDENTIALS=true

# Rate Limiting (Higher limits for testing)
RATE_LIMIT_GENERAL_REQUESTS_PER_MINUTE=2000
RATE_LIMIT_API_REQUESTS_PER_MINUTE=10000
RATE_LIMIT_AUTH_REQUESTS_PER_MINUTE=120
RATE_LIMIT_LOGIN_REQUESTS_PER_MINUTE=20

# Content Security Policy (Report-only mode)
CSP_ENABLED=true
CSP_REPORT_URI=https://protect-staging.isectech.com/api/csp-report
CSP_REPORT_ONLY=true  # Report-only for testing

# ═══════════════════════════════════════════════════════════════════════════════
# FEATURE FLAGS (Testing Configuration)
# ═══════════════════════════════════════════════════════════════════════════════

# Core Features
FEATURE_MULTI_TENANT=true
FEATURE_RBAC=true
FEATURE_AUDIT_LOGGING=true
FEATURE_MFA=false  # Disabled for easier testing
FEATURE_SSO=true

# Security Features (Relaxed for testing)
FEATURE_IP_WHITELISTING=false
FEATURE_DEVICE_FINGERPRINTING=false
FEATURE_BEHAVIORAL_ANALYSIS=true
FEATURE_THREAT_HUNTING=true

# Integration Features
FEATURE_EXTERNAL_APIS=true
FEATURE_WEBHOOK_NOTIFICATIONS=true
FEATURE_SLACK_INTEGRATION=true
FEATURE_EMAIL_NOTIFICATIONS=true

# Advanced Features (Beta testing)
FEATURE_MACHINE_LEARNING=true
FEATURE_REAL_TIME_ANALYTICS=true
FEATURE_AUTOMATED_RESPONSE=false  # Disabled to prevent accidental actions
FEATURE_COMPLIANCE_REPORTING=true

# Testing Features
FEATURE_DEBUG_MODE=true
FEATURE_PERFORMANCE_PROFILING=true
FEATURE_LOAD_TESTING_MODE=true
FEATURE_MOCK_EXTERNAL_APIS=true

# ═══════════════════════════════════════════════════════════════════════════════
# PERFORMANCE TUNING (Scaled for Staging)
# ═══════════════════════════════════════════════════════════════════════════════

# Connection Pooling (Smaller pools)
DB_MAX_CONNECTIONS=50
DB_MIN_CONNECTIONS=5
DB_CONNECTION_TIMEOUT_SECONDS=30
DB_IDLE_TIMEOUT_SECONDS=600

# Caching (Smaller cache)
REDIS_MAX_CONNECTIONS=25
REDIS_CONNECTION_TIMEOUT_SECONDS=5
CACHE_TTL_SECONDS=1800  # Shorter TTL for testing
CACHE_MAX_SIZE_MB=256

# API Configuration
API_TIMEOUT_SECONDS=60  # Longer timeout for debugging
API_MAX_REQUEST_SIZE_MB=50  # Larger for testing large payloads
API_COMPRESSION=true
API_KEEP_ALIVE=true

# ═══════════════════════════════════════════════════════════════════════════════
# BACKUP AND DISASTER RECOVERY (Staging)
# ═══════════════════════════════════════════════════════════════════════════════

# Database Backups (Less frequent)
BACKUP_SCHEDULE=0 4 * * *  # Daily at 4 AM UTC
BACKUP_RETENTION_DAYS=7
BACKUP_ENCRYPTION=true
BACKUP_COMPRESSION=true

# Log Retention (Shorter)
LOG_RETENTION_DAYS=30
AUDIT_LOG_RETENTION_DAYS=90
SECURITY_LOG_RETENTION_DAYS=60

# Disaster Recovery (Relaxed SLAs)
DR_RTO_MINUTES=480  # Recovery Time Objective: 8 hours
DR_RPO_MINUTES=60   # Recovery Point Objective: 1 hour
DR_REGION=us-west1

# ═══════════════════════════════════════════════════════════════════════════════
# COMPLIANCE AND GOVERNANCE (Testing)
# ═══════════════════════════════════════════════════════════════════════════════

# Compliance Standards (Testing mode)
COMPLIANCE_SOC2=false  # Not applicable for staging
COMPLIANCE_ISO27001=false  # Not applicable for staging
COMPLIANCE_GDPR=true  # Still required for EU test data
COMPLIANCE_HIPAA=false
COMPLIANCE_PCI_DSS=false

# Data Classification (Relaxed)
DATA_CLASSIFICATION_ENABLED=true
PII_ENCRYPTION_REQUIRED=true
PII_ACCESS_LOGGING=true
SENSITIVE_DATA_MASKING=false  # Disabled for easier debugging

# Audit Configuration (Comprehensive for testing)
AUDIT_ALL_API_CALLS=true
AUDIT_DATA_ACCESS=true
AUDIT_CONFIGURATION_CHANGES=true
AUDIT_USER_ACTIONS=true

# ═══════════════════════════════════════════════════════════════════════════════
# DEPLOYMENT INFORMATION
# ═══════════════════════════════════════════════════════════════════════════════

DEPLOYMENT_TYPE=staging
DEPLOYMENT_STRATEGY=rolling-update  # Faster deployments for testing
HEALTH_CHECK_PATH=/api/health
HEALTH_CHECK_INTERVAL_SECONDS=15  # More frequent for faster feedback
READINESS_CHECK_PATH=/api/ready
LIVENESS_CHECK_PATH=/api/alive

# Build Information (populated by CI/CD)
BUILD_TIMESTAMP=
BUILD_VERSION=
BUILD_COMMIT_SHA=
BUILD_BRANCH=develop
BUILD_PIPELINE_ID=

# ═══════════════════════════════════════════════════════════════════════════════
# TESTING CONFIGURATION
# ═══════════════════════════════════════════════════════════════════════════════

# Load Testing
LOAD_TEST_MAX_CONCURRENT_USERS=100
LOAD_TEST_RAMP_UP_SECONDS=60
LOAD_TEST_DURATION_MINUTES=30

# Integration Testing
INTEGRATION_TEST_TIMEOUT_SECONDS=120
INTEGRATION_TEST_PARALLEL_JOBS=5
INTEGRATION_TEST_DATA_RESET=true

# Performance Testing
PERFORMANCE_TEST_BASELINE_RESPONSE_TIME_MS=500
PERFORMANCE_TEST_MEMORY_LIMIT_MB=1024
PERFORMANCE_TEST_CPU_LIMIT_PERCENT=80

# ═══════════════════════════════════════════════════════════════════════════════
# SECURITY NOTES
# ═══════════════════════════════════════════════════════════════════════════════

# STAGING SECURITY REMINDERS:
# 1. All secret values stored in Google Cloud Secret Manager (staging project)
# 2. OAuth applications configured for staging domains only
# 3. External APIs use sandbox/test keys with limited functionality
# 4. Some security features relaxed for easier testing and debugging
# 5. Higher logging verbosity and longer timeouts for troubleshooting
# 6. Test data should never contain real PII or sensitive information
# 7. Staging environment should be isolated from production networks
# 8. Regular security testing should be performed before production promotion