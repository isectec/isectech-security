# CrowdStrike Falcon EDR Log Format
# Custom format for CrowdStrike Falcon Endpoint Detection and Response logs

name: "crowdstrike_falcon"
pattern: ""
pattern_type: "json"

field_mappings:
  timestamp: "timestamp"
  event_simpleName: "event.action"
  event_platform: "host.os.platform"
  aid: "agent.id"
  aip: "host.ip"
  cid: "organization.id"
  ComputerName: "host.name"
  UserName: "user.name"
  UserSid: "user.id"
  UserPrincipal: "user.email"
  ProcessId: "process.pid"
  ParentProcessId: "process.parent.pid"
  ImageFileName: "process.name"
  CommandLine: "process.command_line"
  CurrentDirectory: "process.working_directory"
  ImageSubsystem: "process.pe.subsystem"
  IntegrityLevel: "process.pe.integrity_level"
  MD5HashData: "process.hash.md5"
  SHA1HashData: "process.hash.sha1"
  SHA256HashData: "process.hash.sha256"
  RawProcessId: "process.entity_id"
  ParentBaseFileName: "process.parent.name"
  ParentCommandLine: "process.parent.command_line"
  GrandParentBaseFileName: "process.ancestor.name"
  FileName: "file.name"
  FilePath: "file.path"
  TargetFileName: "file.target_path"
  SourceFileName: "file.source_path"
  LocalAddressIP4: "source.ip"
  LocalPort: "source.port"
  RemoteAddressIP4: "destination.ip"
  RemotePort: "destination.port"
  Protocol: "network.protocol"
  ConnectionDirection: "network.direction"
  NetworkProfile: "network.type"
  RegObjectName: "registry.key"
  RegValueName: "registry.value"
  RegStringValue: "registry.data.strings"
  RegDwordValue: "registry.data.dword"
  RegQwordValue: "registry.data.qword"
  ServiceName: "service.name"
  ServiceType: "service.type"
  ServiceStartType: "service.start_type"
  DriverName: "driver.name"
  ImageLoaded: "dll.path"
  LoadImageFilename: "dll.name"
  Device: "device.type"
  VolumeDeviceType: "device.bus_type"
  VolumeFileSystemType: "file.filesystem"
  DetectName: "rule.name"
  DetectDescription: "rule.description"
  Severity: "event.severity"
  MaxSeverity: "event.risk_score_norm"
  ThreatScore: "threat.tactic.technique.score"
  Tactic: "threat.tactic.name"
  Technique: "threat.technique.name"
  Objective: "threat.objective"
  PatternDisposition: "event.outcome"
  ExternalApiType: "threat.technique.subtechnique.name"
  SessionId: "user.session.id"
  LogonType: "authentication.logon_type"
  LogonDomain: "user.domain"
  AuthenticationPackage: "authentication.package"
  PrivilegeList: "user.privileges"
  TokenType: "authentication.token_type"
  EventCounter: "event.sequence"
  ConfigBuild: "agent.version"
  ConfigStateHash: "agent.config_hash"
  Entitlements: "agent.entitlements"

timestamp_field: "timestamp"
timestamp_format: "epoch_ms"
severity_field: "Severity"
message_field: "event_simpleName"
source_field: "ComputerName"

preprocessing_rules:
  - "convert_timestamp"
  - "parse_privilege_list"
  - "normalize_process_paths"
  - "extract_mitre_tactics"

validation_rules:
  - "require_computer_name"
  - "require_event_name"
  - "validate_timestamp"
  - "validate_process_hierarchy"

enabled: true
priority: 20

tags:
  - "crowdstrike"
  - "falcon"
  - "edr"
  - "endpoint"
  - "threat_detection"
  - "behavior_analysis"
  - "security"